import requests
from datetime import datetime, timedelta

API_KEY = "a167e3056b9c6a3490700d84615d8dcb"
BASE_URL = "https://api.the-odds-api.com/v4/sports/"

def get_all_sports():
    url = f"{BASE_URL}?apiKey={API_KEY}"
    return requests.get(url).json()

def get_odds(sport_key):
    url = f"{BASE_URL}{sport_key}/odds/?apiKey={API_KEY}&regions=us&oddsFormat=decimal"
    response = requests.get(url).json()
    return response

def filter_upcoming_games(events):
    upcoming = []
    now = datetime.utcnow()
    for e in events:
        start = datetime.fromisoformat(e["commence_time"].replace("Z", "+00:00"))
        if timedelta(hours=24) <= (start - now) <= timedelta(hours=48):
            upcoming.append(e)
    return upcoming
